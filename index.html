<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vaatsalya Community School - 3D Experience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #f0f4f8;
        }
        #scene-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        #overlay-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 3rem 2rem;
            pointer-events: none;
            color: #1a3a61;
        }
        #header {
            text-align: center;
            animation: fadeIn 2s ease-in-out;
        }
        #header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin: 0;
            color: #0c4a6e; /* Tailwind sky-900 */
        }
        #header p {
            font-size: 1.25rem;
            margin-top: 0.5rem;
            font-style: italic;
            color: #075985; /* Tailwind sky-800 */
        }
        #footer {
            text-align: center;
            font-size: 0.9rem;
            animation: fadeIn 2s ease-in-out;
            background-color: rgba(255, 255, 255, 0.7);
            padding: 0.5rem 1rem;
            border-radius: 99px;
            pointer-events: all;
        }

        #modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background-color: white;
            color: #333;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            z-index: 100;
            pointer-events: all;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease-out;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        #modal.visible {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }
        #modal h2 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-top: 0;
            margin-bottom: 1rem;
        }
        #modal p {
            font-size: 1rem;
            margin-bottom: 1.5rem;
        }
        #modal-close {
            background-color: #0ea5e9; /* Tailwind sky-500 */
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 99px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #modal-close:hover {
            background-color: #0284c7; /* Tailwind sky-600 */
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            #header h1 {
                font-size: 1.8rem;
            }
            #header p {
                font-size: 1rem;
            }
            #overlay-content {
                padding: 2rem 1rem;
            }
        }
    </style>
</head>
<body>

    <!-- 3D Scene Container -->
    <div id="scene-container"></div>

    <!-- HTML Overlay -->
    <div id="overlay-content">
        <div id="header">
            <h1>Vaatsalya Community School</h1>
            <p>"A safe and joyful place for your lovely children"</p>
        </div>
        <div id="footer">
            <p>Drag to explore | Click the glowing orbs</p>
        </div>
    </div>

    <!-- Modal for Info -->
    <div id="modal">
        <h2 id="modal-title"></h2>
        <p id="modal-description"></p>
        <button id="modal-close">Close</button>
    </div>

    <!-- Three.js Script -->
    <script type="module">
        import * as THREE from 'https://cdn.skypack.dev/three@0.132.2';
        import { OrbitControls } from 'https://cdn.skypack.dev/three@0.132.2/examples/jsm/controls/OrbitControls.js';

        // --- Core Setup ---
        let scene, camera, renderer, controls;
        let raycaster, mouse;
        const interactiveObjects = [];
        const modalData = {
            "Kindness": "We emphasize treating others with respect, empathy, and compassion.",
            "Creativity": "We integrate creative elements, encouraging students to think critically and imaginatively.",
            "Emotional Support": "A safe and supportive environment where students feel comfortable expressing their emotions.",
            "Innovation": "We promote inquiry-based learning to ask questions and seek innovative solutions."
        };

        const modal = document.getElementById('modal');
        const modalTitle = document.getElementById('modal-title');
        const modalDescription = document.getElementById('modal-description');
        const modalClose = document.getElementById('modal-close');

        modalClose.addEventListener('click', () => modal.classList.remove('visible'));

        function init() {
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xa0e6ff); // Light blue sky
            scene.fog = new THREE.Fog(0xa0e6ff, 10, 50);

            // Camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 5, 12);

            // Renderer
            const container = document.getElementById('scene-container');
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.shadowMap.enabled = true;
            container.appendChild(renderer.domElement);

            // Controls
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 5;
            controls.maxDistance = 25;
            controls.maxPolarAngle = Math.PI / 2 - 0.05; // Don't let camera go below ground
            controls.target.set(0, 2, 0);
            controls.update();

            // --- Lights ---
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);
            scene.add(ambientLight);

            const dirLight = new THREE.DirectionalLight(0xffffff, 1);
            dirLight.position.set(10, 15, 10);
            dirLight.castShadow = true;
            dirLight.shadow.mapSize.width = 2048;
            dirLight.shadow.mapSize.height = 2048;
            scene.add(dirLight);

            // --- Raycasting ---
            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();
            window.addEventListener('click', onClick);
            window.addEventListener('resize', onWindowResize);

            // --- Create World ---
            createGround();
            createSchool();
            createTrees();
            createOrbs();

            // Start animation loop
            animate();
        }

        // --- World Building ---

        function createGround() {
            const groundGeo = new THREE.PlaneGeometry(100, 100);
            const groundMat = new THREE.MeshLambertMaterial({ color: 0x66bb6a }); // Green grass
            const ground = new THREE.Mesh(groundGeo, groundMat);
            ground.rotation.x = -Math.PI / 2;
            ground.receiveShadow = true;
            scene.add(ground);
        }

        function createSchool() {
            const schoolGroup = new THREE.Group();
            
            // Main building
            const mainMat = new THREE.MeshLambertMaterial({ color: 0xfff3e0 }); // Creamy white
            const mainGeo = new THREE.BoxGeometry(4, 3, 5);
            const mainBuilding = new THREE.Mesh(mainGeo, mainMat);
            mainBuilding.position.y = 1.5;
            mainBuilding.castShadow = true;
            schoolGroup.add(mainBuilding);

            // Roof
            const roofMat = new THREE.MeshLambertMaterial({ color: 0xc62828 }); // Red roof
            const roofGeo = new THREE.CylinderGeometry(0, 3, 2, 4, 1); // Pyramid shape
            const roof = new THREE.Mesh(roofGeo, roofMat);
            roof.position.y = 3 + 1;
            roof.rotation.y = Math.PI / 4;
            roof.castShadow = true;
            schoolGroup.add(roof);

            // Door
            const doorMat = new THREE.MeshLambertMaterial({ color: 0x8d6e63 }); // Brown door
            const doorGeo = new THREE.BoxGeometry(0.8, 1.5, 0.1);
            const door = new THREE.Mesh(doorGeo, doorMat);
            door.position.set(0, 0.75, 2.51); // Slightly in front
            schoolGroup.add(door);
            
            schoolGroup.position.y = 0.01; // Sit just on top of ground
            scene.add(schoolGroup);
        }
        
        function createTrees() {
            for(let i = 0; i < 10; i++) {
                const tree = createTree();
                tree.position.set(
                    (Math.random() - 0.5) * 40,
                    0,
                    (Math.random() - 0.5) * 40
                );
                // Avoid placing on school
                if(Math.abs(tree.position.x) > 5 || Math.abs(tree.position.z) > 5) {
                    scene.add(tree);
                }
            }
        }
        
        function createTree() {
            const treeGroup = new THREE.Group();
            
            const trunkMat = new THREE.MeshLambertMaterial({ color: 0x8d6e63 });
            const trunkGeo = new THREE.CylinderGeometry(0.2, 0.3, 1.5, 8);
            const trunk = new THREE.Mesh(trunkGeo, trunkMat);
            trunk.position.y = 0.75;
            trunk.castShadow = true;
            treeGroup.add(trunk);
            
            const leavesMat = new THREE.MeshLambertMaterial({ color: 0x4caf50 });
            const leavesGeo = new THREE.IcosahedronGeometry(1.2, 0);
            const leaves = new THREE.Mesh(leavesGeo, leavesMat);
            leaves.position.y = 2.2;
            leaves.castShadow = true;
            treeGroup.add(leaves);
            
            return treeGroup;
        }

        function createOrbs() {
            const orbGeo = new THREE.SphereGeometry(0.5, 32, 16);
            const materials = [
                { name: "Kindness", color: 0xff69b4, position: [-3, 3, 3] }, // Pink
                { name: "Creativity", color: 0x9c27b0, position: [3, 3, 3] }, // Purple
                { name: "Emotional Support", color: 0x2196f3, position: [-3, 3, -3] }, // Blue
                { name: "Innovation", color: 0xffeb3b, position: [3, 3, -3] } // Yellow
            ];

            materials.forEach(data => {
                const mat = new THREE.MeshPhongMaterial({ 
                    color: data.color, 
                    emissive: data.color, 
                    emissiveIntensity: 0.5,
                    shininess: 100 
                });
                const orb = new THREE.Mesh(orbGeo, mat);
                orb.position.set(data.position[0], data.position[1], data.position[2]);
                orb.name = data.name;
                
                // Add a point light to make it glow
                const light = new THREE.PointLight(data.color, 1, 3);
                orb.add(light);
                
                scene.add(orb);
                interactiveObjects.push(orb);
            });
        }

        // --- Handlers ---

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function onClick(event) {
            // Hide modal if clicking outside
            if (event.target.id !== 'modal' && !modal.contains(event.target)) {
                 modal.classList.remove('visible');
            }

            // Check for 3D object clicks
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(interactiveObjects);

            if (intersects.length > 0) {
                const clickedObject = intersects[0].object;
                const name = clickedObject.name;
                
                if (modalData[name]) {
                    modalTitle.textContent = name;
                    modalDescription.textContent = modalData[name];
                    modal.classList.add('visible');
                }
            }
        }

        // --- Animation Loop ---
        function animate() {
            requestAnimationFrame(animate);

            // Animate orbs
            const time = Date.now() * 0.001;
            interactiveObjects.forEach((orb, i) => {
                orb.position.y = 3 + Math.sin(time + i) * 0.5; // Bob up and down
            });

            controls.update();
            renderer.render(scene, camera);
        }

        // Start everything
        init();

    </script>
</body>
</html>
